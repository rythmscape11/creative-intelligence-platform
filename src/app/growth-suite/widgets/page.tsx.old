'use client';

import { useState } from 'react';
import Link from 'next/link';
import { Zap, Plus, Code, Eye, MousePointer } from 'lucide-react';

const widgetTypes = [
  {
    id: 'exit-intent',
    name: 'Exit Intent Popup',
    description: 'Capture visitors before they leave',
    icon: 'üö™',
    color: 'var(--color-primary-yellow)',
  },
  {
    id: 'countdown',
    name: 'Countdown Timer',
    description: 'Create urgency with time-limited offers',
    icon: '‚è∞',
    color: 'var(--color-accent-orange)',
  },
  {
    id: 'social-proof',
    name: 'Social Proof',
    description: 'Show recent activity and conversions',
    icon: 'üë•',
    color: 'var(--color-primary-yellow)',
  },
  {
    id: 'sticky-bar',
    name: 'Sticky Bar',
    description: 'Persistent top/bottom announcement bar',
    icon: 'üìå',
    color: 'var(--color-primary-lavender)',
  },
];

const mockWidgets = [
  {
    id: '1',
    name: 'Black Friday Exit Popup',
    type: 'exit-intent',
    status: 'active',
    views: 1247,
    interactions: 89,
    ctr: 7.1,
  },
  {
    id: '2',
    name: 'Limited Time Offer Banner',
    type: 'countdown',
    status: 'active',
    views: 3421,
    interactions: 234,
    ctr: 6.8,
  },
];

export default function WidgetsPage() {
  const [showCreateModal, setShowCreateModal] = useState(false);

  return (
    <div className="min-h-screen bg-bg-primary py-12 px-4 sm:px-6 lg:px-8">
      <div className="max-w-7xl mx-auto">
        {/* Header */}
        <div className="mb-8 bg-bg-secondary border border-border-primary rounded-lg p-8 animate-fade-in-up">
          <div className="flex items-center justify-between">
            <div>
              <div className="flex items-center mb-4">
                <div className="w-12 h-12 rounded-lg flex items-center justify-center mr-4 bg-[#F59E0B]">
                  <Zap className="h-6 w-6 text-black" />
                </div>
                <h1 className="text-4xl font-bold text-text-primary">
                  Widget Library
                </h1>
              </div>
              <p className="text-lg text-text-secondary">
                Boost conversions with on-site widgets
              </p>
            </div>
            <button
              onClick={() => setShowCreateModal(true)}
              className="bg-[#F59E0B] text-black hover:bg-[#D97706] rounded-lg px-4 py-2 flex items-center gap-2 transition-all font-semibold"
            >
              <Plus className="h-5 w-5" />
              Create Widget
            </button>
          </div>
        </div>

        {/* Stats Cards */}
        <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
          <div className="bg-bg-tertiary border border-border-primary rounded-lg p-6 stagger-1">
            <div className="flex items-center justify-between mb-2">
              <span className="text-sm font-medium text-text-secondary">
                Active Widgets
              </span>
              <Zap className="h-5 w-5 text-[#F59E0B]" />
            </div>
            <div className="text-3xl font-bold text-text-primary">
              {mockWidgets.filter(w => w.status === 'active').length}
            </div>
          </div>

          <div className="bg-bg-tertiary border border-border-primary rounded-lg p-6 stagger-2">
            <div className="flex items-center justify-between mb-2">
              <span className="text-sm font-medium text-text-secondary">
                Total Views
              </span>
              <Eye className="h-5 w-5 text-[#F59E0B]" />
            </div>
            <div className="text-3xl font-bold text-text-primary">
              {mockWidgets.reduce((sum, w) => sum + w.views, 0).toLocaleString()}
            </div>
          </div>

          <div className="bg-bg-tertiary border border-border-primary rounded-lg p-6 stagger-3">
            <div className="flex items-center justify-between mb-2">
              <span className="text-sm font-medium text-text-secondary">
                Avg CTR
              </span>
              <MousePointer className="h-5 w-5 text-[#F59E0B]" />
            </div>
            <div className="text-3xl font-bold text-text-primary">
              {(mockWidgets.reduce((sum, w) => sum + w.ctr, 0) / mockWidgets.length).toFixed(1)}%
            </div>
          </div>
        </div>

        {/* Widget Types */}
        {showCreateModal && (
          <div className="bg-bg-secondary border border-border-primary rounded-lg p-8 mb-8">
            <div className="flex items-center justify-between mb-6">
              <h2 className="text-2xl font-bold text-text-primary">
                Choose Widget Type
              </h2>
              <button
                onClick={() => setShowCreateModal(false)}
                className="text-sm text-text-secondary hover:text-text-primary"
              >
                Cancel
              </button>
            </div>

            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
              {widgetTypes.map((type) => (
                <Link
                  key={type.id}
                  href={`/growth-suite/widgets/create?type=${type.id}`}
                  className="bg-bg-tertiary border border-border-primary rounded-lg p-6 transition-all duration-300 hover:scale-[1.02] hover:border-border-hover"
                >
                  <div className="text-4xl mb-3">{type.icon}</div>
                  <h3 className="text-lg font-semibold mb-2 text-text-primary">
                    {type.name}
                  </h3>
                  <p className="text-sm text-text-secondary">
                    {type.description}
                  </p>
                </Link>
              ))}
            </div>
          </div>
        )}

        {/* Active Widgets */}
        <div className="space-y-6">
          <h2 className="text-2xl font-bold text-text-primary">
            Your Widgets
          </h2>

          {mockWidgets.length === 0 ? (
            <div className="bg-bg-secondary border border-border-primary rounded-lg p-12 text-center">
              <Zap className="h-16 w-16 mx-auto mb-4 text-text-tertiary" />
              <h3 className="text-xl font-semibold mb-2 text-text-primary">
                No widgets yet
              </h3>
              <p className="mb-6 text-text-secondary">
                Create your first widget to start boosting conversions
              </p>
              <button
                onClick={() => setShowCreateModal(true)}
                className="bg-[#F59E0B] text-black hover:bg-[#D97706] rounded-lg px-4 py-2 flex items-center gap-2 transition-all font-semibold"
              >
                <Plus className="h-5 w-5 mr-2" />
                Create Widget
              </button>
            </div>
          ) : (
            mockWidgets.map((widget, index) => (
              <Link
                key={widget.id}
                href={`/growth-suite/widgets/${widget.id}`}
                className={`bg-bg-secondary border border-border-primary rounded-lg p-6 transition-all duration-300 hover:scale-[1.02] hover:shadow-xl block ${
                  index < 3 ? `stagger-${index + 1}` : ''
                }`}
              >
                <div className="flex items-start justify-between">
                  <div className="flex-1">
                    <div className="flex items-center mb-2">
                      <h3 className="text-xl font-semibold mr-3"
>
                        {widget.name}
                      </h3>
                      <span className={`px-3 py-1 rounded-full text-xs font-medium ${
                        widget.status === 'active' 
                          ? 'bg-green-100 text-green-800'
                          : 'bg-gray-100 text-gray-800'
                      }`}>
                        {widget.status}
                      </span>
                    </div>
                    <p className="text-sm mb-4"
>
                      {widgetTypes.find(t => t.id === widget.type)?.name}
                    </p>
                    <div className="flex flex-wrap gap-4 text-sm">
                      <div>
                        <span>
                          Views:
                        </span>
                        <span className="ml-2 font-medium"
>
                          {widget.views.toLocaleString()}
                        </span>
                      </div>
                      <div>
                        <span>
                          Interactions:
                        </span>
                        <span className="ml-2 font-medium"
>
                          {widget.interactions}
                        </span>
                      </div>
                      <div>
                        <span>
                          CTR:
                        </span>
                        <span className="ml-2 font-medium"
>
                          {widget.ctr}%
                        </span>
                      </div>
                    </div>
                  </div>
                  <button className="btn btn-secondary ml-4">
                    <Code className="h-4 w-4 mr-2" />
                    Get Code
                  </button>
                </div>
              </Link>
            ))
          )}
        </div>

        {/* Free Tier Notice */}
        <div className="mt-8 bg-bg-tertiary border border-border-primary rounded-lg p-6">
          <div className="flex items-start">
            <Zap className="h-5 w-5 mr-3 flex-shrink-0 mt-0.5"
 />
            <div>
              <h4 className="font-semibold mb-1"
>
                Free Tier Limits
              </h4>
              <p className="text-sm"
>
                Run 2 active widgets with up to 10,000 pageviews per month. 
                <Link href="/pricing" className="ml-1 underline"
>
                  Upgrade for more widgets
                </Link>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}

